---
base: "[[ナレッジベース.base]]"
作成者: Katsubo Katsubo
カテゴリー:
  - JavaScript
作成日時: 2025-06-22T16:49:00
---
## 1. 前置インクリメントと後置インクリメント

### ■ 前置インクリメント（`++x`）

- 変数の値を「**増やしてから返す**」
- 例：
```plain text
let x = 5;
let y = ++x; // x=6, y=6

```

### ■ 後置インクリメント（`x++`）

- 変数の値を「**返してから増やす**」
- 例：
```plain text
let x = 5;
let y = x++; // x=6, y=5

```

### 【比較表】

| 書き方 | 処理順 | 返り値 | 実行後のx |
| --- | --- | --- | --- |
| `++x` | 先に+1 | 増やした後 | 増えた値 |
| `x++` | 後で+1 | 増やす前 | 増えた値 |

### 用途

- `++x` : 「加算してから使う」直感的な用途に最適
- `x++` : 「使った後で加算したい」イテレータやfor文などで便利
※イテレータとは…コレクション（配列やリストなど）の要素を1つずつ順番に取り出すための仕組みやオブジェクトのこと。for文やfor...ofなどのループでも内部的に使われている。イテレータを使うことで、繰り返し処理を簡単に記述できる。

---

## 2. `for` 文とインクリメントの順序

`for` 文のカウンタ部分で `i++` も `++i` も動作はほぼ同じ。

- どちらも「ループ本体の後」にインクリメントされる。
- 初回ループは初期値そのまま。

```plain text
for (let i = 0; i < 3; i++) {
  console.log(i); // 0, 1, 2
}

```

---

## 3. クロージャによる状態保持

### ■ カウンター実装例

```plain text
function createCounter(init) {
    let currentValue = init;
    return {
        increment: () => ++currentValue,
        decrement: () => --currentValue,
        reset: () => currentValue = init
    };
}

```

### ■ ポイント

- `currentValue` はクロージャで「関数内に隠された変数」として保持される
- 何度呼んでも値はオブジェクト内で保持され続ける
- `reset` が正しく実装されていないと、値が初期化されない

### ■ よくあるバグ

- `reset` で `currentValue = init` を忘れると、リセットしても値が変わらない
- `return currentValue++` など後置インクリメントを使うと、加算前の値が返るため意図とズレやすい

---

## 4. まとめと指針

- **直感的な用途には前置インクリメント（**`**++x**`**）が安全**
- **for文など「今の値を使ってから加算」したい場合は後置（**`**x++**`**）も便利**
- **クロージャで値を持つ関数ではリセット処理の実装に注意**

---

### 参考コードと例

```plain text
const counter = createCounter(5);
console.log(counter.increment()); // 6
console.log(counter.reset());     // 5
console.log(counter.decrement()); // 4
```

---