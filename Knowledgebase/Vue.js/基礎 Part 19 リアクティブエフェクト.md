---
base: "[[ナレッジベース.base]]"
作成者: Katsubo Katsubo
カテゴリー:
  - Vue.js
作成日時: 2025-12-06T18:10:00
---
## 1. リアクティブエフェクトとは何か

リアクティブエフェクトとは、リアクティブなデータが変化したときに自動で再実行される関数のこと。

Vueのリアクティブシステムの中心となる仕組みで、コンポーネントの更新やcomputed、watchなどはすべてこの上に成り立っている。

---

## 2. 登場する3つの要素

```plain text
┌──────────────┐
│ ① リアクティブなデータ │ reactive(), ref()
└──────────────┘

┌──────────────┐
│ ② エフェクト（関数）    │ effect(() => {...})
└──────────────┘

┌──────────────┐
│ ③ Vueの監視システム    │ 依存関係の記録と再実行
└──────────────┘

```

---

## 3. 依存関係が登録される仕組み

エフェクトの中でリアクティブデータを読み取ると、Vueが「この関数はこのデータに依存している」と記録する。

```plain text
              effect 実行中
                    │
                    ▼
┌──────────────┐
│ ① データにアクセス │
└──────────────┘
                    │
                    ▼
③ Vueの監視システムが依存関係を登録

```

具体例：

```javascript
effect(() => {
  console.log(state.count);
});

```

この場合、「このeffectはstate.countに依存している」と内部で記録される。

---

## 4. データが変わった時の流れ

リアクティブデータが変更されると、監視システムが該当するエフェクトを全て再実行する。

```plain text
┌──────────────┐
│ state.count が変化│
└──────────────┘
           │
           ▼
③ 監視システムが検知
           │
           ▼
② エフェクトを再実行

```

具体例：

```javascript
state.count++;
// これにより先ほどの effect が再度実行される

```

---

## 5. UI更新との関係

Vueのコンポーネントのレンダリング関数そのものがエフェクトとして登録されるため、テンプレート内で使用されているリアクティブデータが変わると自動でUIが再描画される。

```plain text
データ変更
     ↓
Vueの監視システムがレンダリング関数を再実行
     ↓
UIが自動更新される

```

---

## 6. computed と watch もリアクティブエフェクトの応用

### computed

内部でeffectを使い、依存する値が変わったときに自動で再計算される。キャッシュ機能も持つ。

```javascript
const double = computed(() => state.count * 2);

```

### watch

変更をトリガーに副作用を実行する仕組み。依存値の追跡はeffectと同じ。

```javascript
watch(() => state.count, (value) => {
  console.log(value);
});

```

---

## 7. Vueの構造としての位置づけ

リアクティブエフェクトはVue全体の根幹となる。以下のような構造になる。

```plain text
              ┌───────────────────────┐
              │ Vueの根幹：リアクティブエフェクト │
              └───────────────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        ▼                                    ▼                                    ▼
┌──────────────┐    ┌──────────────┐    ┌────────────────────────────┐
│ computed     │    │ watch        │    │ コンポーネントのUI更新     │
└──────────────┘    └──────────────┘    └────────────────────────────┘

```

computedやwatch、UI更新は全てリアクティブエフェクトという仕組みの上に成立している。

---

## 8. 実装をイメージしやすい擬似コード

Vueのレンダリング更新は内部的には次のように動いているとイメージできる。

```javascript
effect(() => {
  renderComponent();
});

```

内部ではテンプレートがレンダリング関数に変換され、それがeffectとして登録されるため、リアクティブな値が変わるとコンポーネントの再描画が自動で行われる。

---

## 9. まとめ

- リアクティブエフェクトは「データが変わったときに自動実行される関数」
- Vueはエフェクトとデータの依存関係を自動で追跡する
- データ変更時にエフェクトを再実行し、UIや計算結果が更新される
- computed、watch、UIレンダリングはすべてこの仕組みの上に成り立つ

Vueの「自動で更新される仕組み」は、このリアクティブエフェクトが中心となって支えている。

## 関連
- [[基礎 Part 4 ref関数]]
- [[基礎 Part 18 computed]]
- [[基礎 Part 21 watchEffect]]
