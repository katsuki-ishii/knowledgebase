---
base: "[[ナレッジベース.base]]"
作成者: Katsubo Katsubo
カテゴリー:
  - CS
作成日時: 2025-12-06T11:53:00
---
# 改行コードとは

改行を表す制御文字であり、人間が Enter を押したときに OS やエディタが自動で挿入する。実際に画面に「\n」などが入力されているわけではなく、内部的に LF や CRLF といったバイトが記録されている。

## 主な改行コードの種類

### LF (\n)

Unix 系 OS (Linux, macOS) の標準。行送りのみを意味する。現代の開発環境では最も一般的で推奨される。

### CR (\r)

古い Mac OS の標準。行頭へ戻る動作のみを意味する。現在はほぼ使用されない。

### CRLF (\r\n)

Windows の標準。行頭へ戻る CR と行送りの LF を組み合わせた形。タイプライターの仕様を引き継いだ歴史的理由により採用されている。

## 種類が生まれた理由

改行が物理動作だった時代の名残りが現在の OS に残っている。タイプライターは CR と LF を別々に扱っていたため、初期コンピュータもこの仕様を基に実装した。その後、OS ごとに異なる方針を採用し、改行コードの分裂が発生した。

## 実際に改行コードが入力される仕組み

ユーザーが Enter を押すと、OS やエディタが該当する改行コードを自動で挿入する。\n や \r\n をユーザーが文字としてタイプしているわけではなく、あくまで内部的な制御文字として扱われる。プログラミング言語で "\n" と書く場合は、制御文字を挿入するためのエスケープ表現であって、そのままの文字列ではない。

## 改行コードが原因で発生する問題

OS ごとの違いが原因で、以下のようなエラーや混乱が起きる。

- Windows の CRLF が Linux 環境でエラーを引き起こす
- bash が CR (\r) を不正な文字として扱い "^M" エラーを出す
- JSON や YAML の構文が壊れる
- Git の差分が無意味に増える

## Git における改行コードの扱い

Git は改行コードの統一を図るために自動変換機能を持つ。特に core.autocrlf 設定が問題を引き起こしやすい。

### core.autocrlf の挙動

- true: checkout 時に LF→CRLF、commit 時に CRLF→LF
- false: 自動変換しない
- input: commit 時のみ CRLF→LF

Windows では true が設定されている場合が多く、LF を CRLF に戻そうとするため警告が出やすい。

## 改行コード警告の例

```plain text
warning: LF will be replaced by CRLF the next time Git touches it

```

これは編集したファイルは LF なのに、Git が次の操作で CRLF に書き換えようとする際に発生する警告である。Git の挙動が LF 統一を妨げている状態を意味する。

## 推奨される設定

### Git 側の設定

```plain text
git config --global core.autocrlf false

```

自動変換を止め、Git が勝手に CRLF を注入することを防ぐ。

### .gitattributes による統一

```plain text
* text eol=lf

```

リポジトリ全体の改行コードを強制的に LF に統一できる。チーム開発では必須。

### エディタ側の設定

VSCode などで改行コードを LF に固定する。これにより新規作成ファイルがすべて LF になる。

## Windows と mac の違い

Windows は OS の内部仕様として CRLF を使用するが、エディタと Git の設定を調整すれば LF 統一で開発できる。mac はもともと LF 文化のため、追加設定の必要性が低い。ただし、Windows ユーザーと同じリポジトリを扱う場合は .gitattributes を使って統一したほうがよい。

## まとめ

- 改行コードは OS の歴史的背景により複数存在する
- 現代では LF が事実上の標準
- Windows でも Git とエディタを調整すれば LF 統一可能
- Git の core.autocrlf や .gitattributes が改行コード管理の要になる
- 改行コード問題は環境差による典型的なトラブルだが、設定を整えれば完全に防げる

## 関連
- [[設定ファイル言語]]
