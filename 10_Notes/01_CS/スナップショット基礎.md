---

aliases:

- Snapshot
    
- スナップショット
    
- バックアップとの違い
    
- Point in Time
    

---
## 概要

[[スナップショット基礎|スナップショット]]とは、**ある瞬間（[[スナップショット基礎|Point in Time]]）の状態を丸ごと保存する仕組み**である。  
後からその時点に完全に戻す（ロールバック）ことを目的とする。

---

## [[スナップショット基礎|スナップショット]]の本質

[[スナップショット基礎|スナップショット]]には以下の共通点がある。
- 時点：いつの状態か
    
- 状態：データ・設定・構成などを含む
    
- 巻き戻し：保存した時点に戻せる
    

「今の状態を保存して、失敗したら戻る」ための仕組みである。

---

## 図解：[[スナップショット基礎|スナップショット]]とは何か

```
時刻 12:00
┌─────────────┐
│ OS            │
│ アプリ        │
│ 設定          │
│ データ        │
└─────────────┘
        ↓ Snapshot

時刻 13:00（変更後）
┌─────────────┐
│ OS            │
│ アプリ        │
│ 設定（変更）  │
│ データ        │
└─────────────┘
```

[[スナップショット基礎|スナップショット]]を復元すると、12:00 の状態に完全に戻る。

---

## 「全部取るのに差分」とは何か

### 利用者視点（論理）

- [[スナップショット基礎|スナップショット]]は「その瞬間の全状態」として扱われる
    
- 復元すると完全な状態が再現される
    

### システム内部（物理）

- 初回[[スナップショット基礎|スナップショット]]：すべて保存
    
- 2回目以降：変更された部分のみ保存（差分）
    

---

## 図解：差分[[スナップショット基礎|スナップショット]]

```
Snapshot #1
[A][B][C][D][E]

Snapshot #2（Cのみ変更）
      [C']
```

復元時には以下のように合成される。

```
[A] ← Snapshot #1
[B] ← Snapshot #1
[C']← Snapshot #2
[D] ← Snapshot #1
[E] ← Snapshot #1
```

結果として、[[スナップショット基礎|Snapshot]] #2 時点の完全な状態が再構築される。

結論：

- 論理的にはフル
    
- 物理的には差分
    

矛盾ではなく、効率化のための設計である。

---

## [[スナップショット基礎|バックアップとの違い]]

|観点|[[スナップショット基礎|スナップショット]]|バックアップ|
|---|---|---|
|主目的|巻き戻し|災害・完全復旧|
|保存先|同一システム内が多い|別の場所|
|速度|速い|遅め|
|保存方式|差分が多い|フルコピーが多い|

[[スナップショット基礎|スナップショット]]はバックアップの代替にはならない。  
併用が前提である。

---

## 具体例①：AWS EBS [[スナップショット基礎|スナップショット]]

### 内容

- EC2 に接続された EBS（ディスク）の状態を保存
    
- 内部的には差分保存
    
- S3 に管理される
    

### 図解

```
EC2
 └ EBS
    ├ Block A
    ├ Block B
    ├ Block C
        ↓ Snapshot
S3（差分管理）
```

### 用途

- 作業前の保険
    
- 障害時の復元
    
- AMI 作成の元データ
    

---

## 具体例②：DynamoDB の場合

### ポイント

- DynamoDB に「[[スナップショット基礎|スナップショット]]」という名称の機能は存在しない
    
- ディスクを意識しないサーバレス設計
    

### オンデマンドバックアップ

- ある瞬間のテーブル全体を保存
    
- 新しいテーブルとして復元
    
- 実質的には[[スナップショット基礎|スナップショット]]的な性質を持つ
    

### PITR（Point-in-Time Recovery）

- 過去35日以内の任意の秒に戻せる
    
- 時系列の変更履歴を内部的に保持
    

---

## 図解：DynamoDB PITR

```
過去 ←───────────────→ 現在
|----|----|----|----|
     ↑
  この瞬間に復元
```

---

## 実務での使い分け

- 作業前：[[スナップショット基礎|スナップショット]]
    
- 定期：バックアップ（別場所）
    
- 重要データ：PITR + バックアップ
    

---

## まとめ

- [[スナップショット基礎|スナップショット]]は「巻き戻し」のための仕組み
    
- バックアップは「避難」のための仕組み
    
- 論理と物理を分けて考えると理解しやすい
    
- DynamoDB ではバックアップが[[スナップショット基礎|スナップショット]]的役割を担う