---
base: "[[Web.History.base]]"
作成者: Katsubo Katsubo
カテゴリー:
  - Web
  - CS
作成日時: 2026-02-15T12:00:00
tags:
  - 分散システム
  - システム設計
aliases:
  - 分散システム
  - distributed system
---

# [[分散システム]]

---

## 1. [[分散システム]]とは何か

**[[分散システム]]とは、ネットワークで接続された複数の独立したコンピュータが、利用者から見ると**一つのシステムのように振る舞う**仕組みである。

重要なのは「**独立している**」という点である。

- それぞれ別のCPUを持つ
- それぞれ別のメモリを持つ
- それぞれ別の故障リスクを持つ
- それぞれ別の時計を持つ

単一コンピュータとは前提が根本的に異なる。

---

## 2. 単一コンピュータとの違い

### 単一コンピュータ

- メモリは共有
- 時間は一つ
- 命令の順番は保証される
- 故障は「全部止まる」か「止まらない」かの二択

### [[分散システム]]

- メモリは共有できない
- 時間は一致しない
- メッセージは遅延・消失・重複する
- 一部だけ壊れる（**部分故障**）が発生する

### 図解

**単一マシン**

```
┌─────────────────────────┐
│  CPU / Memory / Disk   │
└─────────────────────────┘
```

**[[分散システム]]**

```
[Server A] ────\
                 \
                  Network
                 /
[Server B] ────/
```

各サーバは独立している。

---

## 3. [[分散システム]]が生まれた背景

### (1) ネットワークの誕生

1970年代、**[[ARPANET]]**により遠隔地のコンピュータ同士を接続する必要が生まれた。研究機関間でデータ共有を行うためである。

ここで初めて「複数のコンピュータを協調させる」問題が発生した。

### (2) 経済的理由

大型コンピュータを1台用意するよりも、小型マシンを複数台並べる方が安価になった。

- **スケールアップ**（1台を強化）から**スケールアウト**（台数を増やす）への転換が起きた。

### (3) Webの爆発的成長

世界中から同時アクセスが発生するようになり、1台のサーバでは処理できなくなった。

例：

- ECサイト
- 検索エンジン
- 動画配信サービス

これにより実用的な[[分散システム]]が必須になった。

---

## 4. [[分散システム]]の本質的な問題

### 4.1 通信はメッセージのみ

単一マシンでは共有メモリに直接アクセスできる。

```
x = 5
```

分散ではメッセージで依頼するしかない。

```
「xを5にして」と送信する
```

このメッセージは次の**不確実性**を持つ。

- 遅れる
- 消える
- 重複する
- 順番が入れ替わる

---

### 4.2 部分故障

[[分散システム]]特有の問題である。

```
Aは生きている
Bは停止している
```

しかし**AはBが停止しているのか、単に応答が遅れているのか判断できない**。

これは理論的に[[ITと不完全さに惹かれる理由|完全]]な判定が**不可能**である。

---

### 4.3 合意問題（Consensus）

複数のサーバで**同じ決定**を下す必要がある。

例：

- データベースの値を1にするか2にするか
- どのサーバをリーダーにするか

ネットワーク分断や故障がある中で、全員が同じ結論に到達する仕組みが必要になる。

これを解くための研究が**合意アルゴリズム**である。

---

### 4.4 時間の不一致

サーバごとに時計が異なる。

```
Server A: 10:00
Server B: 09:59
```

どちらが先に更新したか分からない。

そのため[[分散システム]]では**物理時間ではなく論理的な順序付け**を考える。

---

## 5. [[分散システム]]の設計上の問い

- どこまで壊れても動作させるか
- データをどこまで一致させるか
- 同時更新をどう処理するか
- リトライ回数をどう設計するか
- 重複処理をどう防ぐか

単一マシンではほとんど考えなくてよい問題である。

---

## 6. CAPのジレンマ

[[分散システム]]では以下の三つを**同時に[[ITと不完全さに惹かれる理由|完全]]には満たせない**。

| 頭文字 | 意味 |
|--------|------|
| **C** | 一貫性（Consistency） |
| **A** | 可用性（Availability） |
| **P** | 分断耐性（Partition Tolerance） |

ネットワーク分断が起きる前提では、どれかを犠牲にする設計になる。

---

## 7. 抽象的な本質

[[分散システム]]とは

> **「中央が存在しない状況で秩序を作る技術」**

である。

- 中央集権的な単一マシンでは、制御は容易である。
- 分散環境では、各ノードが独立し、不確実な通信を通して協調しなければならない。

そのため[[分散システム]]は

> **「不確実な世界で協調を実現する学問」**

と定義できる。

---

## 8. 具体例

### 例1：ロードバランサ配下のWebサーバ

```
        Client
           |
    Load Balancer
       /       \
      /         \
Server A      Server B
```

- どちらのサーバが処理してもよい設計が必要
- セッションを共有しないと問題が発生する

### 例2：データベースのレプリケーション

```
      Primary DB
           |
    ┌──────┼──────┐
    |      |      |
Replica1  Replica2  ...
```

- 書き込みはPrimary
- 読み取りはReplica
- **データ同期遅延**の問題が発生する

---

## 9. まとめ

[[分散システム]]は、複数の独立したコンピュータを協調させ、利用者に**一つのシステムとして見せる**ための理論と実装の体系である。

**背景**

- ネットワークの誕生
- 経済的合理性
- Webの大規模化

**分散環境での根本問題**

- 部分故障
- メッセージ不確実性
- 合意問題
- 時間の不一致

これらを扱うのが[[分散システム]]の**理論と実践**である。
